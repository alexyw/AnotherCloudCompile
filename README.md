参照了P3TER的代码，但自行更改了部分，更加适合自己用
